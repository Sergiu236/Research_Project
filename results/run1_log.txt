[INFO] Reading CSV from: data/raw/cicids2017.csv
[INFO] Using label column: ' Label'
[INFO] NaN or inf values in features before cleaning: 5734
[INFO] After sampling: 50000 rows
[INFO] Class distribution after sampling:
  - BENIGN          ->  40150 samples (0.8030)
  - BOTNET          ->     35 samples (0.0007)
  - BRUTE FORCE     ->     27 samples (0.0005)
  - DOS/DDOS        ->   6724 samples (0.1345)
  - FTP-PATATOR     ->    140 samples (0.0028)
  - INFILTRATION    ->      1 samples (0.0000)
  - PORT SCAN       ->   2807 samples (0.0561)
  - SSH-PATATOR     ->    104 samples (0.0021)
  - WEB ATTACK      ->     12 samples (0.0002)
[WARN] Dropping extremely rare classes (<3 samples) to allow stratified split:
  - INFILTRATION: 1 samples
[INFO] Class distribution AFTER dropping rare classes:
  - BENIGN          ->  40150 samples (0.8030)
  - BOTNET          ->     35 samples (0.0007)
  - BRUTE FORCE     ->     27 samples (0.0005)
  - DOS/DDOS        ->   6724 samples (0.1345)
  - FTP-PATATOR     ->    140 samples (0.0028)
  - PORT SCAN       ->   2807 samples (0.0561)
  - SSH-PATATOR     ->    104 samples (0.0021)
  - WEB ATTACK      ->     12 samples (0.0002)
[INFO] Train size: 29999
[INFO] Val size:   10000
[INFO] Test size:  10000

======================
TRAINING MODEL: Logistic Regression
======================
[INFO] Fitting model...
[INFO] Evaluating on test set...

Classification report (multi-class):
              precision    recall  f1-score   support

      BENIGN     0.9771    0.8117    0.8867      8030
      BOTNET     0.0253    0.5714    0.0485         7
 BRUTE FORCE     0.1176    0.3333    0.1739         6
    DOS/DDOS     0.6762    0.7903    0.7288      1345
 FTP-PATATOR     0.0434    0.6071    0.0810        28
   PORT SCAN     0.4963    0.9661    0.6558       561
 SSH-PATATOR     0.3125    0.9524    0.4706        21
  WEB ATTACK     0.0294    0.5000    0.0556         2

    accuracy                         0.8167     10000
   macro avg     0.3347    0.6916    0.3876     10000
weighted avg     0.9042    0.8167    0.8482     10000

Confusion matrix:
[[6518  154   13  509  220  542   44   30]
 [   3    4    0    0    0    0    0    0]
 [   1    0    2    0    0    0    0    3]
 [ 119    0    1 1063  154    8    0    0]
 [  11    0    0    0   17    0    0    0]
 [  19    0    0    0    0  542    0    0]
 [   0    0    0    0    1    0   20    0]
 [   0    0    1    0    0    0    0    1]]

[INFO] Inference time on test set: 0.0065 seconds
[INFO] Approx. throughput: 1,536,543.9 flows/second

======================
TRAINING MODEL: Random Forest
======================
[INFO] Fitting model...
[INFO] Evaluating on test set...

Classification report (multi-class):
              precision    recall  f1-score   support

      BENIGN     0.9986    0.9991    0.9989      8030
      BOTNET     0.5714    0.5714    0.5714         7
 BRUTE FORCE     0.8000    0.6667    0.7273         6
    DOS/DDOS     0.9985    0.9970    0.9978      1345
 FTP-PATATOR     1.0000    1.0000    1.0000        28
   PORT SCAN     0.9964    0.9964    0.9964       561
 SSH-PATATOR     1.0000    1.0000    1.0000        21
  WEB ATTACK     1.0000    0.5000    0.6667         2

    accuracy                         0.9981     10000
   macro avg     0.9206    0.8413    0.8698     10000
weighted avg     0.9981    0.9981    0.9981     10000

Confusion matrix:
[[8023    3    0    2    0    2    0    0]
 [   3    4    0    0    0    0    0    0]
 [   2    0    4    0    0    0    0    0]
 [   4    0    0 1341    0    0    0    0]
 [   0    0    0    0   28    0    0    0]
 [   2    0    0    0    0  559    0    0]
 [   0    0    0    0    0    0   21    0]
 [   0    0    1    0    0    0    0    1]]

[INFO] Inference time on test set: 0.0314 seconds
[INFO] Approx. throughput: 318,805.7 flows/second
